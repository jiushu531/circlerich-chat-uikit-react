import{__spreadArray as s}from"tslib";import e from"tim-js-sdk/tim-js-friendship";import n from"../../constants.js";import{JSONStringToParse as i}from"../untils.js";var t=function(s){var t=null;return s.filter((function(s){var l;return s.type===e.TYPES.MSG_CUSTOM&&(t=i(null===(l=null==s?void 0:s.payload)||void 0===l?void 0:l.data)),!t||(null==t?void 0:t.businessID)!==n.TYPE_TYPING}))},l=function(s,e){var n,i={messageList:[],lastMessageID:"",isSameLastMessageID:!1};s.length<=1&&(i.messageList=s),i.messageList=[s[s.length-1]];for(var t=function(e){i.messageList.every((function(n){var i;return(null==n?void 0:n.ID)!==(null===(i=s[e])||void 0===i?void 0:i.ID)}))&&i.messageList.unshift(s[e])},l=s.length-2;l>=0;l-=1)t(l);return i.messageList.length>=1&&(i.lastMessageID=null===(n=null==i?void 0:i.messageList[i.messageList.length-1])||void 0===n?void 0:n.ID),i.messageList=i.messageList.filter((function(s){return!(null==s?void 0:s.isDeleted)})),i.isSameLastMessageID=(null==i?void 0:i.lastMessageID)===(null==e?void 0:e.lastMessageID),i},r=function(e,n){var i=s([],e,!0),t=i.findIndex((function(s){return(null==s?void 0:s.ID)===(null==n?void 0:n.ID)}));return i[t]=n,i},o=function(e,n){var i=s([],e,!0),t=i.findIndex((function(s){return(null==s?void 0:s.ID)===(null==n?void 0:n.ID)}));return i.splice(t,1),i};export{r as handleEditMessage,t as handleMessage,l as handleMessageList,o as handleRemoveMessage};
