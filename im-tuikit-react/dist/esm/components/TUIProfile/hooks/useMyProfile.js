import{__awaiter as t,__generator as n,__assign as r}from"tslib";import{useState as e,useCallback as i,useEffect as o}from"react";import u from"tim-js-sdk/tim-js-friendship";import{useTUIKitContext as l}from"../../../context/TUIKitContext.js";import"react/jsx-runtime";function a(){var a=this,c=e(null),s=c[0],f=c[1],d=l("useMyProfile"),m=d.tim,v=d.myProfile,p=i((function(){return t(a,void 0,void 0,(function(){var t;return n(this,(function(n){switch(n.label){case 0:return v?(f(v),[3,3]):[3,1];case 1:return[4,null==m?void 0:m.getMyProfile()];case 2:t=n.sent(),f(null==t?void 0:t.data),n.label=3;case 3:return[2]}}))}))}),[m]),P=i((function(e){return t(a,void 0,void 0,(function(){var t,i;return n(this,(function(n){switch(n.label){case 0:return[4,null==m?void 0:m.updateMyProfile(e)];case 1:return t=n.sent(),i=r({},s),Object.keys(t.data).map((function(n){return i[n]=t.data[n],n})),f(i),[2,t]}}))}))}),[m]),h=function(t){console.log("onProfileUpdated",t.data)};return o((function(){return t(a,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return[4,p()];case 1:return t.sent(),[2]}}))})),null==m||m.on(u.EVENT.PROFILE_UPDATED,h),function(){null==m||m.off(u.EVENT.PROFILE_UPDATED,h)}}),[m]),{myProfile:s,updateMyProfile:P}}export{a as useMyProfile};
