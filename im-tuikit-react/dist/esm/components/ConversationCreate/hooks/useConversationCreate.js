import{__awaiter as r,__generator as t}from"tslib";import{useState as e,useEffect as n}from"react";import i from"tim-js-sdk/tim-js-friendship";import{strChineseFirstPy as o}from"../static/word.js";import{useProfile as u}from"../../../hooks/useProfile.js";var c=function(c,s,f){var a=e({}),d=a[0],l=a[1],v=function(r){var t=r.trim(),e=t.charCodeAt(0);return e>40869||e<19968?t.charAt(0):o.charAt(e-19968)},h=function(){return r(void 0,void 0,void 0,(function(){var r,e,n,o,u;return t(this,(function(t){switch(t.label){case 0:return r=s.filter((function(r){return r.type===i.TYPES.CONV_C2C})).slice(0,5).map((function(r){return r.userProfile})),[4,c.getFriendList()];case 1:return e=t.sent(),n=e.code,o=e.data,0===n&&(u=m(o.map((function(r){return r.profile})),r),l(u),f&&f(u,l)),[2]}}))}))},m=function(r,t){void 0===t&&(t=[]);for(var e={"Frequently Contacted":t,"#":[]},n=65;n<=90;n+=1)e[String.fromCharCode(n)]=[];return r.forEach((function(r){var t=r.nick,n=r.userID,i=v(t||n);i>="a"&&i<="z"?e[i.toLocaleUpperCase()].push(r):i<"A"||i>"z"?e["#"].push(r):e[i].push(r)})),Object.keys(e).forEach((function(r){e[r].sort((function(r,t){var e=r.nick,n=r.userID,i=t.nick,o=t.userID;return e||n<i||o||e||n===i||o?1:-1}))})),e},p=u(c).getUserProfile;return n((function(){h()}),[c]),{getFirstLetter:v,queryFriendList:h,getFriendListSortSearchResult:function(e){return r(void 0,void 0,void 0,(function(){var r,n,i,o;return t(this,(function(t){switch(t.label){case 0:return e?[4,p([e])]:[2,d];case 1:return r=t.sent().data,n={},i=!1,Object.keys(d).forEach((function(r){n[r]=d[r].filter((function(r){var t=r.nick,n=r.userID,o=t?t.includes(e):n.includes(e);return i=i||o,o}))})),"TencentCloudDemo"===(null===(o=process.env)||void 0===o?void 0:o.REACT_APP_ONLINE)?[2,n]:[2,i?n:m(r)]}}))}))},friendListSortResult:d}};export{c as useConversationCreate};
