import{__awaiter as t,__generator as e}from"tslib";import{useCallback as n}from"react";import{MESSAGE_OPERATE as o,CONSTANT_DISPATCH_TYPE as r}from"../../../constants.js";import{useTUIKitContext as a}from"../../../context/TUIKitContext.js";import{useTUIChatStateContext as u}from"../../../context/TUIChatStateContext.js";import{useTUIChatActionContext as i}from"../../../context/TUIChatActionContext.js";import"react/jsx-runtime";import{useHandleQuoteMessage as c}from"./useHandleQuoteMessage.js";var l=function(l){var s=l.state,f=l.dispatch;l.focus;var T=l.textareaRef,d=a("useMessageInputText").tim,p=i(),v=p.sendMessage,x=p.createTextMessage,m=p.operateMessage,g=u("TUIMessageInputDefault").operateData[o.QUOTE],E=c().handleQuoteMessage,y=["Enter","NumpadEnter"],D=n((function(t){t.preventDefault(),t&&t.target&&f({type:r.SET_TEXT,getNewText:function(e){return t.target.value}})}),[d]),h=function(n){return t(void 0,void 0,void 0,(function(){var t,a,u;return e(this,(function(e){return null==n||n.preventDefault(),s.text?(t={},g&&(t.messageReply=E(g)),a=x({payload:{text:s.text},cloudCustomData:JSON.stringify(t)}),v(a),f({getNewText:function(t){return""},type:r.SET_TEXT}),m(((u={})[o.QUOTE]=null,u)),[2]):[2]}))}))},S=n((function(t){!(null==t?void 0:t.ctrlKey)&&y.indexOf(null==t?void 0:t.code)>-1&&(null==t||t.preventDefault(),h(t)),(null==t?void 0:t.ctrlKey)&&y.indexOf(null==t?void 0:t.code)>-1&&f({type:r.SET_TEXT,getNewText:function(t){return"".concat(t,"\n")}})}),[h,f]),N=n((function(n){return t(void 0,void 0,void 0,(function(){var t;return e(this,(function(e){return n.preventDefault(),n.clipboardData&&n.clipboardData.items?((t=n.clipboardData.getData("text"))&&f({type:r.SET_TEXT,getNewText:function(e){return"".concat(e).concat(t)}}),[2]):[2]}))}))}),[T]),w=n((function(t){var e;f({type:r.SET_TEXT,getNewText:function(e){return"".concat(e).concat(t)}}),null===(e=null==T?void 0:T.current)||void 0===e||e.focus()}),[T]),C=n((function(t){var e;f({type:r.SET_TEXT,getNewText:function(){return"".concat(t)}}),null===(e=null==T?void 0:T.current)||void 0===e||e.focus()}),[T]);return{handleChange:D,handleSubmit:h,handleKeyDown:S,handlePasete:N,insertText:w,setText:C}};export{l as useMessageInputText};
