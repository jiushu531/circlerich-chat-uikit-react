import{__assign as o}from"tslib";import{jsx as e,jsxs as t,Fragment as r}from"react/jsx-runtime";import n,{useState as i,useRef as s}from"react";import{useTUIKitContext as a}from"../../context/TUIKitContext.js";import v from"./hooks/useConversationList.js";import{ConversationPreview as c}from"../ConversationPreview/ConversationPreview.js";import{Icon as m}from"../Icon/Icon.js";import{IconTypes as l}from"../Icon/type.js";import"tim-js-sdk/tim-js-friendship";import{ConversationListContainer as u}from"../ConversationPreview/ConversationListContainer.js";import{Profile as C}from"../Profile/Profile.js";import{ConversationSearchInput as f}from"../ConversationSearch/ConversationSearchInput.js";import{ConversationSearchResult as p}from"../ConversationSearch/ConversationSearchResult.js";import{ConversationCreate as d}from"../ConversationCreate/ConversationCreate.js";import"../ConversationCreate/ConversationGroupTypeInfo.js";import{getDisplayTitle as h}from"../ConversationPreview/utils.js";import{useConversationUpdate as j}from"./hooks/useConversationUpdate.js";function P(n){var P=n.Preview,w=n.Container,I=void 0===w?u:w,g=n.onConversationListUpdated,L=a("TUIConversationList"),U=L.tim,x=L.customClasses,y=L.conversation,S=L.setActiveConversation,T=L.setTUIProfileShow,k=i(0),A=k[0],N=k[1],b=v(U,(function(o,e){o.length&&S(y||o[0])})),E=b.conversationList,R=b.setConversationList;j(R,g,(function(){return N((function(o){return o+1}))}));var D=i(""),G=D[0],K=D[1],V=i(E),q=V[0],z=V[1],B=i(!1),F=B[0],H=B[1],J=a().myProfile,M=s(null);return e("div",o({className:"tui-conversation ".concat(x||""),ref:M},{children:F?e(d,{conversationList:E,setConversationCreated:H}):t(r,{children:[e(C,{profile:J,handleAvatar:function(){T(!0)}}),t("div",o({className:"tui-conversation-header"},{children:[e(f,{value:G,clearable:!0,onChange:function(o){var e,t;if(K(null===(e=o.target)||void 0===e?void 0:e.value),null===(t=o.target)||void 0===t?void 0:t.value){var r=E.filter((function(e){var t;return h(e).includes(null===(t=o.target)||void 0===t?void 0:t.value)}));z(r)}else z([])}}),e("div",o({className:"tui-conversation-create-icon"},{children:e(m,{onClick:function(){K(""),H(!0)},type:l.CREATE,height:24,width:24})}))]})),e(I,o({setConversationList:R},{children:0===E.length?e("div",o({style:{padding:"0 20px"}},{children:"No conversation"})):G?e(p,{Preview:P,searchValue:G,result:q}):E.map((function(t){return e(c,o({},{activeConversation:y,conversation:t,setActiveConversation:S,Preview:P,conversationUpdateCount:A}),t.conversationID)}))}))]})}))}var w=n.memo(P);export{w as TUIConversationList,P as UnMemoTUIConversationList};
