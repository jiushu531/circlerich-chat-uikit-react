"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),t=require("react"),n=require("../../../constants.js"),a=require("../../../context/TUIKitContext.js"),r=require("../../../context/TUIChatStateContext.js"),u=require("../../../context/TUIChatActionContext.js");require("react/jsx-runtime");var o=require("./useHandleQuoteMessage.js");exports.useMessageInputText=function(T){var i=T.state,s=T.dispatch;T.focus;var c=T.textareaRef,l=a.useTUIKitContext("useMessageInputText").tim,d=u.useTUIChatActionContext(),f=d.sendMessage,x=d.createTextMessage,E=d.operateMessage,_=r.useTUIChatStateContext("TUIMessageInputDefault").operateData[n.MESSAGE_OPERATE.QUOTE],C=o.useHandleQuoteMessage().handleQuoteMessage,v=["Enter","NumpadEnter"],S=t.useCallback((function(e){e.preventDefault(),e&&e.target&&s({type:n.CONSTANT_DISPATCH_TYPE.SET_TEXT,getNewText:function(t){return e.target.value}})}),[l]),p=function(t){return e.__awaiter(void 0,void 0,void 0,(function(){var a,r,u;return e.__generator(this,(function(e){return null==t||t.preventDefault(),i.text?(a={},_&&(a.messageReply=C(_)),r=x({payload:{text:i.text},cloudCustomData:JSON.stringify(a)}),f(r),s({getNewText:function(e){return""},type:n.CONSTANT_DISPATCH_TYPE.SET_TEXT}),E(((u={})[n.MESSAGE_OPERATE.QUOTE]=null,u)),[2]):[2]}))}))},g=t.useCallback((function(e){!(null==e?void 0:e.ctrlKey)&&v.indexOf(null==e?void 0:e.code)>-1&&(null==e||e.preventDefault(),p(e)),(null==e?void 0:e.ctrlKey)&&v.indexOf(null==e?void 0:e.code)>-1&&s({type:n.CONSTANT_DISPATCH_TYPE.SET_TEXT,getNewText:function(e){return"".concat(e,"\n")}})}),[p,s]),N=t.useCallback((function(t){return e.__awaiter(void 0,void 0,void 0,(function(){var a;return e.__generator(this,(function(e){return t.preventDefault(),t.clipboardData&&t.clipboardData.items?((a=t.clipboardData.getData("text"))&&s({type:n.CONSTANT_DISPATCH_TYPE.SET_TEXT,getNewText:function(e){return"".concat(e).concat(a)}}),[2]):[2]}))}))}),[c]),A=t.useCallback((function(e){var t;s({type:n.CONSTANT_DISPATCH_TYPE.SET_TEXT,getNewText:function(t){return"".concat(t).concat(e)}}),null===(t=null==c?void 0:c.current)||void 0===t||t.focus()}),[c]),D=t.useCallback((function(e){var t;s({type:n.CONSTANT_DISPATCH_TYPE.SET_TEXT,getNewText:function(){return"".concat(e)}}),null===(t=null==c?void 0:c.current)||void 0===t||t.focus()}),[c]);return{handleChange:S,handleSubmit:p,handleKeyDown:g,handlePasete:N,insertText:A,setText:D}};
