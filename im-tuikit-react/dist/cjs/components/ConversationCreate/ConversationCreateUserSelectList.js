"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),t=require("react/jsx-runtime"),r=require("react"),n=require("../Input/Input.js"),s=require("../Icon/Icon.js"),i=require("../Icon/type.js"),a=require("./ConversationCreateSelectView.js"),c=require("../Avatar/Avatar.js"),o=require("./hooks/useConversationCreate.js"),u=require("../../context/TUIKitContext.js"),l=require("./ConversationCreate.js"),v=require("../../hooks/useConversation.js"),d=require("../Toast/index.js");exports.ConversationCreateUserSelectList=function(h){var p=this,x=h.isCreateGroup,_=h.selectList,C=h.setSelectList,j=h.className,g=h.conversationList,f=h.setIsCreateGroup,m=h.setConversationCreated,I=h.setPageState,N=r.useState(""),k=N[0],b=N[1],q=u.useTUIKitContext(),y=q.tim,S=q.setActiveConversation,w=r.useState({}),A=w[0],L=w[1],T=o.useConversationCreate(y,g,(function(e){L(e)})).getFriendListSortSearchResult,D=v.useConversation(y).createConversation,E=r.useRef(new Map);return t.jsxs(t.Fragment,{children:[t.jsx(n.Input,{className:"tui-conversation-create-search-input",placeholder:"Search",clearable:!0,value:k,onChange:function(t){return e.__awaiter(p,void 0,void 0,(function(){var r,n;return e.__generator(this,(function(e){switch(e.label){case 0:return r=t.target.value,b(r),n=L,[4,T(r)];case 1:return n.apply(void 0,[e.sent()]),[2]}}))}))},prefix:t.jsx(s.Icon,{type:i.IconTypes.SEARCH,height:16,width:16})}),x&&t.jsx(a.ConversationCreateSelectView,{selectList:_,setSelectList:C}),!x&&t.jsxs("div",e.__assign({role:"presentation",className:"tui-user",onClick:function(){f(!0),E.current.clear(),C([])}},{children:[t.jsx(s.Icon,{type:i.IconTypes.ADD}),t.jsx("div",e.__assign({className:"tui-user-name active"},{children:"New Group"}))]})),t.jsx("div",e.__assign({className:"tui-conversation-create ".concat(j)},{children:t.jsx("div",e.__assign({className:"tui-conversation-create-container"},{children:t.jsx("div",e.__assign({className:"tui-group-container"},{children:Object.keys(A).map((function(r){return 0!==A[r].length&&t.jsxs("div",e.__assign({className:"tui-group-box"},{children:[t.jsx("div",e.__assign({className:"title"},{children:r})),A[r].map((function(n,s){var i=n.userID,a=n.nick,o=n.avatar;return t.jsxs("label",e.__assign({role:"presentation",className:"tui-user tui-user-checkbox-label",htmlFor:"userChecked-".concat(r,"-").concat(i),onClick:function(t){!function(t){e.__awaiter(p,void 0,void 0,(function(){var r,n;return e.__generator(this,(function(e){switch(e.label){case 0:return x?[2]:(r=t.userID,[4,D("C2C".concat(r))]);case 1:return n=e.sent(),m(!1),S(n),[2]}}))}))}(n)}},{children:[t.jsx(c.Avatar,{size:30,image:o}),t.jsx("div",e.__assign({className:"tui-user-name"},{children:a||"".concat(i)})),x&&t.jsx("input",{onChange:function(t){!function(t,r,n){void 0===n&&(n=[]);var s=r.userID,i=t.target.checked;n.forEach((function(e){e.checked=i})),i?_.push({profile:r,domList:n}):_.splice(_.findIndex((function(e){return e.profile.userID===s})),1),C(e.__spreadArray([],_,!0))}(t,n,E.current.get(i))},type:"checkbox",ref:function(e){!function(e,t){if(t){E.current.has(e)||E.current.set(e,[]);var r=E.current.get(e);0!==r.length&&r.some((function(e){return e.id===t.id}))||r.push(t)}}(i,e)},id:"userChecked-".concat(r,"-").concat(i),className:"tui-user-checkbox"})]}),i)}))]}),r)}))}))}))})),x&&t.jsx("div",e.__assign({className:"tui-conversation-create-next-container"},{children:t.jsx("div",e.__assign({role:"presentation",className:"tui-conversation-create-next",onClick:function(){_&&0===_.length?d.Toast({text:"Participant cannot be empty.",type:"error"}):I(l.PageStateTypes.CREATE_DETAIL)}},{children:"Next"}))}))]})};
